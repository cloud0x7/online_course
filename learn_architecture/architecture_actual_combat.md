
#### 架构师如何判断技术演进的方向
* 技术演进的动力：从业务角度观察
* 业务类别
  - 产品类：技术创新推动业务发展（用户选择产品的动力是“功能”）
  - 服务类：业务发展推动技术发展（用户选择服务的动力是“规模”）
  - 综合分析，除非开创新的技术能够推动或者创造新的业务，其它情况都是**业务推动了技术发展**


#### 互联网技术演进的模式
* 业务复杂性
  - 初创期：创新的业务点，吸引用户，快速迭代试错，不断完善
  - 发展期：快速实现大量需求
    - 堆功能期：不断增加新功能
    - 优化期：重构、分层、升级硬件等
    - 架构期：达到优化极限，拆分系统
    - 竞争期：
      - 重复造轮子 - 解决：平台化（存储、数据库、缓存）
      - 系统交互一团乱 - 服务化
    - 成熟期：技术求精
* 用户规模
  - （0-1万用户）：初创期 - 无压力
  - （1-10万）：初创期 - 单机压力，加机器，但不多
  - （10-100万）：发展期 - 较大压力，拆分子业务 
  - （100-1000万）：竞争期 - 很大压力，集群、多机房等
  - （1千万-1亿）：竞争成熟期 - 非常大压力，架构重来
  - （1亿+）：成熟期 - 没有哪个行业能同时容纳两家1亿+用户的公司


#### 互联网架构模板
* 存储层：SQL、NoSQL、小文件、大文件
* 开发层：开发框架、服务器、容器
* 服务层：配置中心、服务中心、消息队列
* 网络层：负载均衡、CDN、多机房、多中心
* 用户层：用户管理、消息推送、存储云、图片云
* 业务层：网购、IM、搜索……


#### 互联网架构模板：“存储层”技术
* SQL：开源免费
  - 业务发展中期，独立为中间件，使用开源的MySQL Router、360的Atlas
* NoSQL：弥补关系数据库无法存储数据结构、性能不高的缺点
* 小文件：
  - 得益于开源，业务起步阶段就可以考虑统一存储：HBase, Hadoop
* 大文件：视频或业务日志
  - Hadoop、HBase、Storm、Hive


#### 互联网架构模板：“开发层”和“服务层”技术
* 开发层技术
  - 开发框架：选择成熟的框架，避免追新
  - Web服务器：选择和语言有关，Apache支持大多数语言
  - 容器：以Docker为代表
    - 基于Docker的自动化、智能化运维将会成为主流
    - “微服务”的发展方向
* 服务层技术：主要目标是降低系统间关联复杂度
  - 配置中心：
    - 集中配置，效率高；可实现程序化规则检查；备份系统，可快速搭建新系统和恢复旧系统
  - 服务中心：解决跨系统依赖的“配置”和“调度”问题
    - 服务名字系统：将服务解析为“host+port+api”
    - 服务总线系统：
  - 消息队列：
 

#### 互联网架构模板：“网络层”技术
* 负载均衡
* DNS：地理级别。优点是通用成本低；缺点是缓存时间长，不灵活
* Nginx、LVS、F5：机器级别
* CDN
* 多机房
* 多中心：主要目标是灾备
  
#### 互联网架构模板：“用户层”和“业务层”技术
* 用户层技术
  - 用户管理
    - 单点登录
    - 授权登录：OAuth 2.0
  - 消息推送：短信、邮件、站内信、App推送
    - App推送：iOS使用APNS；安卓各厂商不一致，三方友盟、极光
    - 自己实现推送：
      - （唯一标识、注册、注销）
      - 连接管理：连接保活是细节和黑科技最多的地方（应用互相拉起、手机厂商开白名单）
      - 消息管理
  - 存储云和图片云
* 业务层技术 


#### 互联网架构模板：“平台”技术
* 运维平台
  - 职责
    - 配置：资源管理（机器管理、IP管理、虚拟机管理）
    - 部署：系统发布（包管理、灰度发布管理、回滚等）
    - 监控：收集数据
    - 应急：故障后处理（停止程序、下线机器、切换IP）
  - 设计要素
    - 标准化：
    - 平台化：集成运维操作
    - 自动化：固化重复操作
    - 可视化：提升数据查看效率
* 测试平台
  - 单元测试、集成测试、接口测试、性能测试
  - 设计要素：自动化
* 数据平台
  - 职责
    - 数据管理：数据采集、存储、访问、安全
    - 数据分析：数据统计、机器学习、深度学习
    - 数据应用：广告、推荐、报表、防刷、异常检测等
* 管理平台
  - 职责
    - 身份认证
    - 权限控制
    
    
#### 架构重构内功心法第一式：有的放矢
* 重构的要求更高
  - 业务不能停止
  - 关联多方，牵扯多
  - 旧架构的约束
* 架构不能满足业务时，表现形式
  - 响应慢、数据错误、访问失败
  - 宕机、数据库瘫痪、数据丢失等
  - 开发效率降低
* 首要任务：识别真正要通过重构解决的重要问题，集中力量快速解决


#### 架构重构内功心法第二式：合纵连横
* 合纵：重构时间长，占用研发资源、影响业务开发，需要各部分游说、沟通、合作
* 连横：换位思考、合作双赢、关注长期（重构对别人有什么好处、解决什么问题、带来什么收益）


#### 架构重构内功心法第三式：运筹帷幄
* 分段实施
  - 根据优先级、重要性、实施难度等划分不同的阶段
  - 每个阶段聚集于一个整体的目标，集中精力和资源解决一类问题
* 策略
  - 优先级排序
  - 问题分类
  - 先易后难
  - 循序渐进
  

#### 开源项目：如何 选择、使用以及二次开发


#### 谈谈APP架构的演进


#### 架构实战：架构设计文档模板

 